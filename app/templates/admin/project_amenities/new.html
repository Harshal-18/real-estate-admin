{% extends "admin/base.html" %}

{% block title %}New Project Amenity - Premium Real Estate Admin{% endblock %}
{% block page_title %}New Project Amenity{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin-enhanced.css') }}">
{% endblock %}

{% block content %}
<!-- Enhanced Page Header -->
<div class="page-header">
    <div class="container-fluid">
        <h1><i class="fas fa-swimming-pool"></i> Add Premium Project Amenity</h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('admin.dashboard') }}">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('admin.project_amenities') }}">Project Amenities</a></li>
                <li class="breadcrumb-item active">New Amenity</li>
            </ol>
        </nav>
    </div>
</div>

<div class="luxury-card">
    <div class="card-header">
        <h5><i class="fas fa-swimming-pool"></i> Project Amenity Information</h5>
    </div>
    <div class="card-body">
        <form method="POST" id="projectAmenityForm">
            <!-- Basic Information -->
            <div class="row">
                <div class="col-md-12">
                    <h6 class="text-primary mb-3"><i class="fas fa-info-circle"></i> Basic Information</h6>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="project_id" class="form-label"><i class="fas fa-building"></i> Project *</label>
                        <select class="form-select" id="project_id" name="project_id" required>
                            <option value="">Select Project</option>
                            {% for project in projects %}
                            <option value="{{ project.project_id }}">{{ project.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="amenity_id" class="form-label"><i class="fas fa-star"></i> Amenity *</label>
                        <select class="form-select" id="amenity_id" name="amenity_id" required>
                            <option value="">Select Amenity</option>
                            {% for amenity in amenities %}
                            <option value="{{ amenity.amenity_id }}">{{ amenity.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Specifications -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <h6 class="text-primary mb-3"><i class="fas fa-ruler-combined"></i> Specifications</h6>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="area_size" class="form-label"><i class="fas fa-expand-arrows-alt"></i> Area Size</label>
                        <div class="input-with-unit">
                            <input type="number" step="0.01" class="form-control" id="area_size" name="area_size" min="0" placeholder="Enter area">
                            <div class="input-unit">sq ft</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="capacity" class="form-label"><i class="fas fa-users"></i> Capacity</label>
                        <div class="input-with-unit">
                            <input type="number" class="form-control" id="capacity" name="capacity" min="0" placeholder="Enter capacity">
                            <div class="input-unit">persons</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="floors_available" class="form-label"><i class="fas fa-layer-group"></i> Available on Floors</label>
                        <input type="text" class="form-control" id="floors_available" name="floors_available" placeholder="e.g., Ground, 1-5, All">
                    </div>
                </div>
            </div>
            
            <!-- Operational Details -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <h6 class="text-primary mb-3"><i class="fas fa-clock"></i> Operational Details</h6>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="operating_hours" class="form-label"><i class="fas fa-business-time"></i> Operating Hours</label>
                        <input type="text" class="form-control" id="operating_hours" name="operating_hours" placeholder="e.g., 6:00 AM - 10:00 PM">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="maintenance_charge" class="form-label"><i class="fas fa-rupee-sign"></i> Maintenance Charge</label>
                        <div class="input-with-unit">
                            <input type="number" step="1" class="form-control" id="maintenance_charge" name="maintenance_charge" min="0" placeholder="Enter charge">
                            <div class="input-unit">₹/month</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="booking_required" class="form-label"><i class="fas fa-calendar-check"></i> Booking Required</label>
                        <select class="form-select" id="booking_required" name="booking_required">
                            <option value="no">No Booking Required</option>
                            <option value="yes">Advance Booking Required</option>
                            <option value="optional">Optional Booking</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="distance_from_entrance" class="form-label"><i class="fas fa-walking"></i> Distance from Main Entrance</label>
                        <div class="input-with-unit">
                            <input type="number" step="1" class="form-control" id="distance_from_entrance" name="distance_from_entrance" min="0" placeholder="Enter distance">
                            <div class="input-unit">meters</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="staff_count" class="form-label"><i class="fas fa-user-tie"></i> Staff Count</label>
                        <div class="input-with-unit">
                            <input type="number" class="form-control" id="staff_count" name="staff_count" min="0" placeholder="Enter count">
                            <div class="input-unit">staff</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="age_restriction" class="form-label"><i class="fas fa-child"></i> Age Restriction</label>
                        <input type="text" class="form-control" id="age_restriction" name="age_restriction" placeholder="e.g., 18+, All Ages, Kids Only">
                    </div>
                </div>
            </div>
            
            <!-- Quality & Features -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <h6 class="text-primary mb-3"><i class="fas fa-star"></i> Quality & Features</h6>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="quality_rating" class="form-label"><i class="fas fa-star"></i> Quality Rating</label>
                        <div class="input-with-unit">
                            <input type="number" step="0.1" class="form-control" id="quality_rating" name="quality_rating" min="1" max="5" placeholder="1-5">
                            <div class="input-unit">★ stars</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="brand" class="form-label"><i class="fas fa-tag"></i> Brand/Vendor</label>
                        <input type="text" class="form-control" id="brand" name="brand" placeholder="e.g., Technogym, Johnson Lifts">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="year_installed" class="form-label"><i class="fas fa-calendar"></i> Year Installed</label>
                        <div class="input-with-unit">
                            <input type="number" class="form-control" id="year_installed" name="year_installed" min="2000" max="2030" placeholder="YYYY">
                            <div class="input-unit">year</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Description -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <h6 class="text-primary mb-3"><i class="fas fa-file-alt"></i> Description</h6>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-12">
                    <div class="mb-3">
                        <label for="description" class="form-label"><i class="fas fa-comment-alt"></i> Amenity Description</label>
                        <textarea class="form-control" id="description" name="description" rows="4" placeholder="Describe the amenity features, quality, and unique aspects"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Settings -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <h6 class="text-primary mb-3"><i class="fas fa-cog"></i> Settings</h6>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-3">
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="is_available" name="is_available" checked>
                        <label class="form-check-label" for="is_available">
                            <i class="fas fa-check-circle"></i> Currently Available
                        </label>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="is_premium" name="is_premium">
                        <label class="form-check-label" for="is_premium">
                            <i class="fas fa-crown"></i> Premium Amenity
                        </label>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="is_chargeable" name="is_chargeable">
                        <label class="form-check-label" for="is_chargeable">
                            <i class="fas fa-rupee-sign"></i> Chargeable
                        </label>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="wheelchair_accessible" name="wheelchair_accessible">
                        <label class="form-check-label" for="wheelchair_accessible">
                            <i class="fas fa-wheelchair"></i> Wheelchair Accessible
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Form Actions -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <hr>
                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('admin.project_amenities') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left"></i> Back to Project Amenities
                        </a>
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-luxury">
                                <i class="fas fa-plus"></i> Add Project Amenity
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Auto-suggest capacity based on amenity type
    $('#amenity_id').on('change', function() {
        const amenityText = $('#amenity_id option:selected').text().toLowerCase();
        
        if (amenityText.includes('gym')) {
            $('#capacity').val(50);
        } else if (amenityText.includes('pool')) {
            $('#capacity').val(100);
        } else if (amenityText.includes('parking')) {
            $('#capacity').val(200);
        } else if (amenityText.includes('clubhouse')) {
            $('#capacity').val(150);
        }
    });
    
    // Toggle maintenance charge field based on chargeable status
    $('#is_chargeable').on('change', function() {
        if ($(this).is(':checked')) {
            $('#maintenance_charge').parent().parent().show();
        } else {
            $('#maintenance_charge').val('');
            $('#maintenance_charge').parent().parent().hide();
        }
    });
    
    // Form validation
    $('#projectAmenityForm').on('submit', function(e) {
        let isValid = true;
        
        // Check required fields
        const requiredFields = ['project_id', 'amenity_id'];
        requiredFields.forEach(field => {
            const element = $('#' + field);
            if (!element.val()) {
                element.addClass('is-invalid');
                isValid = false;
            } else {
                element.removeClass('is-invalid');
            }
        });
        
        // Validate quality rating
        const rating = parseFloat($('#quality_rating').val());
        if (!isNaN(rating) && (rating < 1 || rating > 5)) {
            $('#quality_rating').addClass('is-invalid');
            isValid = false;
        }
        
        if (!isValid) {
            e.preventDefault();
            alert('Please fill in all required fields correctly.');
        }
    });
});
</script>
{% endblock %}